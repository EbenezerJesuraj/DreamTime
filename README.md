# DreamTime: Finding AlexNet for Time Series Classification
This is the companion repository for our paper titled "DreamTime: Finding AlexNet for Time Series Classification" available on [ArXiv](#). 

## Inception module
![inception module](https://github.com/hfawaz/DreamTime/blob/master/pngs/inception-module.png)

## Data
The data used in this project comes from the [UCR/UEA archive](http://timeseriesclassification.com/TSC.zip). 
We used the 85 datasets listed [here](https://www.cs.ucr.edu/~eamonn/time_series_data/).  

## Requirements
You will need to install the following packages present in the [requirements.txt](https://github.com/hfawaz/DreamTime/blob/master/requirements.txt) file. 

## Code
The code is divided as follows: 
* The [main.py](https://github.com/hfawaz/DreamTime/blob/master/main.py) python file contains the necessary code to run an experiement. 
* The [utils](https://github.com/hfawaz/DreamTime/tree/master/utils) folder contains the necessary functions to read the datasets and visualize the plots.
* The [classifiers](https://github.com/hfawaz/DreamTime/tree/master/classifiers) folder contains two python files: (1) [inception.py](https://github.com/hfawaz/DreamTime/tree/master/classifiers/inception.py) contains the inception network; (2) [nne.py](https://github.com/hfawaz/DreamTime/tree/master/classifiers/nne.py) contains the code that ensembles a set of Inception networks. 

### Run DreamTime on a single Archive
You should issue the following command ```python3 main.py DreamTime```. 

### Run the hyperparameter search for DreamTime on a single Archive
You should issue the following command ```python3 main.py DreamTime_xp```. 

### Run the length experiment on the InlineSkate dataset
You should first issue the following command ```python3 main.py run_length_xps``` to generate the resamples.
Then you should issue the following command ```python3 main.py DreamTime``` but make sure that the ```InlineSkateXPs``` is chosen [here](https://github.com/hfawaz/DreamTime/blob/690aa776081e77214db95ddd5c53c7ec3ac79d61/utils/constants.py#L22). 

### Receptive field
To run the experiments on the synthetic dataset, you should issue the following command ```python3 receptive.py```. 

## Results
The raw results can be found [here](https://github.com/hfawaz/DreamTime/blob/master/results.csv) and generated using the following command ```python3 main.py generate_results_csv```.

### Critical difference diagrams
If you would like to generate such a diagram, take a look at [this code](https://github.com/hfawaz/cd-diagram)!

![cd diagram](https://github.com/hfawaz/DreamTime/blob/master/pngs/cd-diagram.png)

### Training time plots
These plots were generated using the [matplotlib](https://matplotlib.org/) library. 

Accuracy vs train size             |  Accuracy vs series length
:-------------------------:|:-------------------------:
![training time size](https://github.com/hfawaz/DreamTime/blob/master/pngs/train-time-size.png) | ![training time length](https://github.com/hfawaz/DreamTime/blob/master/pngs/train-time-length.png)

### Receptive field
This plot was generated by issuing this command ```python3 receptive.py plot_results```.

![receptive field](https://github.com/hfawaz/DreamTime/blob/master/pngs/plot-receptive-field.png)

## Reference

If you re-use this work, please cite:

```
@article{IsmailFawaz2019dreamTime,
  Title                    = {DreamTime: Finding AlexNet for Time Series Classification},
  Author                   = {Ismail Fawaz, Hassan and Lucas, Benjamin and Forestier, Germain and Pelletier, Charlotte and Schmidt, Daniel F. and Weber, Jonathan and Webb, Geoffrey I. and Idoumghar, Lhassane and Muller, Pierre-Alain and Petitjean, François},
  journal                  = {ArXiv},
  Year                     = {2019}
}
```

## Acknowledgement

We would like to thank the providers of the [UCR/UEA archive](http://timeseriesclassification.com/TSC.zip). 
We would also like to thank NVIDIA Corporation for the Quadro P6000 grant and the Mésocentre of Strasbourg for providing access to the cluster.